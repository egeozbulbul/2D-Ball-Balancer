# 🧠 Dynamic Analysis Codes – 2D Ball Balancer Project

This folder contains all MATLAB codes developed for **analyzing**, **simplifying**, and **validating** the nonlinear dynamics of the 2D Ball Balancer system.

---

## 📁 Folder Structure & File Descriptions

> ⚠️ Most files also have a `Simplified` version that uses a reduced EOM derived via symbolic simplification. Full and simplified versions follow the same logic unless noted otherwise.

---

### 1. `eomGraph.m` / `eomGraphSimplified.m`
**Function:**  
Plots the root of the EOM for `phi` given the inputs `x`, `xdot`, `xdotdot`, and `phidot`.

**Usage:**  
Allows **manual inspection** of whether a valid solution (root) exists for a particular combination and whether that root lies within servo limits.

---

### 2. `eomSimplification.m`
**Function:**  
Communicates with `eomIntegratorChain.slx` in Simulink to toggle EOM terms using `Switch` blocks.

**Analysis Output:**
- Relative percentage error
- Standard deviation of error
- Effect of each term on system output

This is useful for identifying **non-essential terms** and simplifying the physical model.

---

### 3. `eomSymbolicDerivation.m`
**Function:**  
Automatically computes the **left-hand side** of the Euler-Lagrange-based equations of motion (EOM) symbolically.

---

### 4. `feasibilityMapping.m` / `feasibilityMappingSimplified.m`
**Function:**  
Explores the entire input space of `x`, `xdot`, `xdotdot`, `phidot` to determine if:
- A root for `phi` exists ✅
- The root is **within servo limits** ➡️ `+1`
- The root exists but **outside limits** ➡️ `-1`
- No root found ➡️ `0`

**Output:**  
- 3D scatter plot for a fixed `x`  
- Aggregate feasibility map across all `x` values  
- Extracted feasible region used for controller design
- Contour map between the region where there are roots present in the servo angle limits and the region where there are roots outside of the servo angle limits + no roots

---

### 5. `contourFitting.m` / `contourFittingSimplified.m`
**Function:**  
Takes the **contour line** (boundary between feasible and infeasible regions) generated by `feasibilityMapping` and fits it using a **polynomial model**.

**Output:**  
- Mathematical expression of the fitted contour  
- Quality metrics (e.g., \( R^2 \) value)

Used for embedding feasibility constraints into Simulink and controller logic.

---

### 6. `parameterBalancing.m`
**Function:**  
Minimizes the **stiffness** of the EOM by reducing the variance among lumped system parameters (mass and inertia values).

**Method:**  
Applies a variance minimization algorithm to compute an optimal set of parameters that make the system more controllable and less sensitive to numerical instability.

---

### 7. `inhull.m`, `polyfitn.m`, `polyvaln.m`
**Source:**  
Downloaded from MATLAB File Exchange.

**Function:**  
Used by the `contourFitting` scripts for:
- Multidimensional polynomial fitting
- Evaluating and checking whether a point lies within a fitted region

---

### 📂 `Datas/`
A subdirectory containing x vs time datas for each term and safe boundary datas for both the full and the simplified version of the EOM

---

## ✅ Summary of Workflow

```mermaid
graph TD;
    A[Symbolic Derivation] --> B[eomSimplification];
    B --> C[eomGraph / Manual Root Checking];
    B --> D[feasibilityMapping];
    D --> E[contourFitting];
    E --> F[Simulink Integration];
    G[parameterBalancing] --> B;
